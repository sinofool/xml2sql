This is written in C#